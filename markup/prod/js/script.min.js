var ui={};ui.initElems=[],ui.init=function(){var a;for(a=0;a<this.initElems.length;a++)this[this.initElems[a]]()},$(function(){ui.init()}),ui.initIndexPage=function(){function a(a){a>4?d.addClass("nav-descriptions_right"):d.removeClass("nav-descriptions_right")}var b=$("#lemon-nav"),c=b.find(".nav-hints__item"),d=b.find(".nav-descriptions"),e=b.find(".lemon__hover-slice"),f=d.find(".nav-descriptions__item"),g=-1,h=0;b.size()&&b.on("mouseenter","#lemon-map area",function(){var b=$(this),d=b.index();clearTimeout(h),c.removeClass("nav-hints__item_active").eq(d).addClass("nav-hints__item_active"),f.removeClass("nav-descriptions__item_active").eq(d).addClass("nav-descriptions__item_active"),e.removeClass("lemon__hover-slice_active").eq(d).addClass("lemon__hover-slice_active"),a(d)}).on("mouseleave","#lemon-map area",function(){h=setTimeout(function(){g>=0?(c.removeClass("nav-hints__item_active").eq(g).addClass("nav-hints__item_active"),f.removeClass("nav-descriptions__item_active").eq(g).addClass("nav-descriptions__item_active"),e.removeClass("lemon__hover-slice_active").eq(g).addClass("lemon__hover-slice_active"),a(g)):(c.removeClass("nav-hints__item_active"),f.removeClass("nav-descriptions__item_active"),e.removeClass("lemon__hover-slice_active"))},100)}).on("click","#lemon-map area",function(a){var b=$(this);b.hasClass("active")?(g=-1,b.removeClass("active")):(g=b.index(),b.addClass("active")),a.preventDefault()})},ui.initElems.push("initIndexPage"),ui.initMessageSend=function(){var a,b,c=$("#feedback"),d=!1;c.size()&&!d&&(a=c.find("input, textarea, select"),c.height(c.height()),c.submit(function(e){b=!1,a.filter("[type=submit]").attr("disabled","disabled").parent().addClass("disabled"),a.filter("[name=name]").each(function(){this.value.match(/^[a-zA-Z\s]{3,}$/)||($(this).addClass("field-error").one("change input",function(){$(this).removeClass("field-error")}),b=!0)}),a.filter("[name=phone]").each(function(){this.value.match(/^[0-9\(\)\s]{7,}$/)||($(this).addClass("field-error").one("change input",function(){$(this).removeClass("field-error")}),b=!0)}),a.filter("[name=email]").each(function(){ui.checkmail(this.value)||($(this).addClass("field-error").one("change input",function(){$(this).removeClass("field-error")}),b=!0)}),a.filter("[name=message]").each(function(){this.value.length<4&&($(this).addClass("field-error").one("change input",function(){$(this).removeClass("field-error")}),b=!0)}),b||d?a.filter("[type=submit]").removeAttr("disabled").parent().removeClass("disabled"):(d=!0,$.ajax({type:"POST",url:c.attr("action"),data:c.serialize(),success:function(b){b.toLowerCase().indexOf("ошибка")>=0?alert(b):c.html(ui.sendFormMessage(b)),d=!1,a.filter("[type=submit]").removeAttr("disabled").parent().removeClass("disabled")},error:function(){alert("Ошибка отправки письма. Попробуйте позже."),d=!1,a.filter("[type=submit]").removeAttr("disabled").parent().removeClass("disabled")}})),e.preventDefault()}))},ui.sendFormMessage=function(a){return"<div class='feedback__message'>"+a+"</div>"},ui.checkmail=function(a){return reg=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/,a.match(reg)?!0:!1},ui.initElems.push("initMessageSend"),ui.initGallery=function(){var a,b={};"Sly"in window&&(a=$(".gallery"),b.elems=[],a.each(function(){var a=$(this),c=a.find(".gallery__list-item");a.find(".gallery__list").width(c.size()*c.eq(1).outerWidth(!0)-44),b.elems.push(new Sly(a.find(".gallery__frame"),{itemNav:"basic",horizontal:1,activateOn:"click",mouseDragging:1,touchDragging:1,releaseSwing:1,swingSpeed:.2,speed:300,elasticBounds:0,easing:"swing",prevPage:a.find(".gallery__prev"),nextPage:a.find(".gallery__next"),pagesBar:a.find(".gallery__switchers"),activatePageOn:"click",pageBuilder:function(a){return'<li class="gallery__switchers-item"><a>'+(a+1)+"</a></li> "}}).init())}))},ui.initElems.push("initGallery"),ui.pagingsHTML=function(a){var b,a=$.extend({active:0,elemsCount:100,perPage:10,elemClass:"pin__pagings__elem",elemActiveClass:"pin__pagings__elem_active",elemDisabledClass:"disabled",emptyElemHtml:"...",maxPagingsCount:8,roundActiveCount:3,emptyElemClass:"pin__pagings__elem_empty",arrows:!1,arrowsClasses:["prev","next"]},a),c=Math.ceil(a.elemsCount/a.perPage),d="";if(a.arrows&&(d+="<li class='"+a.elemClass+" "+a.arrowsClasses[0]+(0==a.active?" "+a.elemDisabledClass:"")+"'><a rel='"+(a.active-1<0?0:a.active-1)+"' href='#'>"+a.arrows[0]+"</a></li>"),c>a.maxPagingsCount){if(a.active>(a.roundActiveCount-1)/2){for(d+="<li class='"+a.elemClass+"'><a rel='1'>1</a></li>\n<li class='"+a.elemClass+" "+a.emptyElemClass+"'>"+a.emptyElemHtml+"</li>\n",b=a.active-(a.roundActiveCount-1)/2;b<a.active;b++)d+="<li class='"+a.elemClass+"'><a rel='"+b+"''>"+(b+1)+"</a></li>\n";d+="<li class='"+a.elemClass+" "+a.elemActiveClass+"'><a rel='"+b+"'>"+(b+1)+"</a></li>\n"}else{for(b=0;b<a.active;b++)d+="<li class='"+a.elemClass+"'><a rel='"+b+"'>"+(b+1)+"</a></li>\n";d+="<li class='"+a.elemActiveClass+" "+a.elemClass+"'><a rel='"+b+"'>"+(b+1)+"</a></li>\n"}if(c-a.active-1>(a.roundActiveCount-1)/2){for(b=a.active+1;b<=a.active+(a.roundActiveCount-1)/2;b++)d+="<li class='"+a.elemClass+"'><a rel='"+b+"'>"+(b+1)+"</a></li>\n";d+="<li class='"+a.elemClass+" "+a.emptyElemClass+"'>"+a.emptyElemHtml+"</li>\n<li class='"+a.elemClass+"'><a rel='"+(c-1)+"'>"+c+"</a></li>\n"}else for(b=a.active+1;c-1>=b;b++)d+="<li class='"+a.elemClass+"'><a rel='"+b+"'>"+(b+1)+"</a></li>\n"}else for(b=0;c-1>=b;b++)d+=b==a.active?"<li class='"+a.elemActiveClass+" "+a.elemClass+"'><a rel='"+b+"'>"+(b+1)+"</a></li>\n":"<li class='"+a.elemClass+"'><a rel='"+b+"'>"+(b+1)+"</a></li>\n";return a.arrows&&(d+="<li class='"+a.elemClass+" "+a.arrowsClasses[1]+(a.active==c-1?" "+a.elemDisabledClass:"")+"'><a rel='"+(a.active+1>c-1?c-1:a.active+1)+"' href='#'>"+a.arrows[1]+"</a></li>"),d},ui.initWorks=function(){var a,b,c=$(".works"),d=$("#works-list"),e=16,f={active:0,perPage:e,elemClass:"pagings__item",elemActiveClass:"pagings__item_active",emptyElemClass:"pagings__item_placer",arrows:["&lt;","&gt;"],arrowsClasses:["pagings__item_prev","pagings__item_next"],elemDisabledClass:"pagings__item_disabled"},g=window.location.hash.match(/p=([0-9]+)/);g&&g[1]&&(g=parseInt(g[1])-1,f.active=g),d.size()&&(a=d.find(".works-list__item"),a.size()>e&&(a.each(function(a){$(this).attr("page-index",parseInt(a/e))}).hide().filter("[page-index="+f.active+"]").show(),f.elemsCount=a.size(),b=$("<nav class='pagings'><ul class='pagings__list'></ul></nav>").insertAfter(d).find(".pagings__list"),b.html(ui.pagingsHTML(f))),c.on("click",".pagings__item a",function(c){var d=Number($(this).attr("rel")),e=window.location.hash.replace(/[&]?p=[0-9]+/,"");f.active=d,a.hide().filter("[page-index="+d+"]").show(),b.html(ui.pagingsHTML(f)),window.location.hash=e.length>2?e+"&p="+(d+1):"?p="+(d+1),c.preventDefault()}))},ui.initElems.push("initWorks");